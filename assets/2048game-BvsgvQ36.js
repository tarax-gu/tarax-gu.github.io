import{d as A,k as C,l as N,E as $,x as V,G as F,o as s,n as h,a as f,b as v,w as c,F as p,q as b,e as n,r as y,t as E,c as x,D as K,g as B,H as i,I as S,J as U,K as q,L as G,M as H}from"./index-D-NTUnPH.js";const I={class:"bordered-main"},J={style:{width:"100px",height:"100px"}},R={style:{"margin-top":"10px"}},O=A({__name:"2048game",setup(T){var l=C([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]);const w=N(()=>{let u=0;for(let e=0;e<l.value.length;e++)for(let a=0;a<l.value[e].length;a++)u+=l.value[e][a];return u});var d=C(!1);$(d,(u,e)=>{u==!1&&e==!0&&(console.log("over"),alert("游戏结束，您的得分为"+w.value))}),V(()=>{document.addEventListener("keydown",k)}),F(()=>{document.removeEventListener("keydown",k)});function k(u){if(d.value==!0)switch(u.key){case"ArrowUp":r("up");break;case"ArrowDown":r("down");break;case"ArrowLeft":r("left");break;case"ArrowRight":r("right");break}}function j(){l.value.forEach((u,e)=>{u.forEach((a,t)=>{l.value[e][t]=0}),d.value=!0})}function g(){for(let u=0;u<l.value.length;u++)for(let e=0;e<l.value[u].length;e++)if(l.value[u][e]==0)return!0;for(let u=0;u<l.value.length-1;u++)for(let e=0;e<l.value[u].length-1;e++)if(l.value[u][e]==l.value[u+1][e]||l.value[u][e]==l.value[u][e+1])return!0;return!1}function D(){const u=Math.random();return u<.8?2:u<.9?4:u<.95?8:u<.99?16:32}function m(){let u=[];if(l.value.forEach((e,a)=>{e.forEach((t,o)=>{t==0&&u.push([a,o])})}),u.length!=0){let e=Math.floor(Math.random()*u.length),a=D();l.value[u[e][0]][u[e][1]]=a}}function r(u){if(u=="up"){for(let e=0;e<4;e++)for(let a=1;a<4;a++)if(l.value[a][e]!=0){let t=a-1;for(;t>=0&&l.value[t][e]==0;)t--;if(t<0)l.value[0][e]=l.value[a][e],l.value[a][e]=0;else if(l.value[t][e]==l.value[a][e])l.value[t][e]=2*l.value[t][e],l.value[a][e]=0;else{let o=l.value[a][e];l.value[a][e]=0,l.value[t+1][e]=o}}}if(u=="down"){for(let e=0;e<4;e++)for(let a=2;a>=0;a--)if(l.value[a][e]!=0){let t=a+1;for(;t<4&&l.value[t][e]==0;)t++;if(t>=4)l.value[3][e]=l.value[a][e],l.value[a][e]=0;else if(l.value[t][e]==l.value[a][e])l.value[t][e]=2*l.value[t][e],l.value[a][e]=0;else{let o=l.value[a][e];l.value[a][e]=0,l.value[t-1][e]=o}}}if(u=="left"){for(let e=0;e<4;e++)for(let a=1;a<4;a++)if(l.value[e][a]!=0){let t=a-1;for(;t>=0&&l.value[e][t]==0;)t--;if(t<0)l.value[e][0]=l.value[e][a],l.value[e][a]=0;else if(l.value[e][t]==l.value[e][a])l.value[e][t]=2*l.value[e][t],l.value[e][a]=0;else{let o=l.value[e][a];l.value[e][a]=0,l.value[e][t+1]=o}}}if(u=="right"){for(let e=0;e<4;e++)for(let a=2;a>=0;a--)if(l.value[e][a]!=0){let t=a+1;for(;t<4&&l.value[e][t]==0;)t++;if(t>=4)l.value[e][3]=l.value[e][a],l.value[e][a]=0;else if(l.value[e][t]==l.value[e][a])l.value[e][t]=2*l.value[e][t],l.value[e][a]=0;else{let o=l.value[e][a];l.value[e][a]=0,l.value[e][t-1]=o}}}m(),d.value=g(),console.log(g())}return(u,e)=>{const a=y("el-row"),t=y("el-col");return s(),h(p,null,[f("div",I,[v(a,null,{default:c(()=>[f("div",null,"分数："+E(w.value),1)]),_:1}),(s(!0),h(p,null,b(n(l),(o,L)=>(s(),x(a,{key:L,gutter:10},{default:c(()=>[(s(!0),h(p,null,b(o,(_,M)=>(s(),x(t,{key:M,span:6},{default:c(()=>[f("div",J,[K(f("div",{class:"grid-content"},E(_),513),[[H,_]])])]),_:2},1024))),128))]),_:2},1024))),128)),v(n(i),{onClick:m},{default:c(()=>[B("开始游戏")]),_:1}),v(n(i),{onClick:j},{default:c(()=>[B("重新开始")]),_:1})]),f("div",R,[v(n(i),{icon:n(S),onClick:e[0]||(e[0]=o=>r("up"))},null,8,["icon"]),v(n(i),{icon:n(U),onClick:e[1]||(e[1]=o=>r("down"))},null,8,["icon"]),v(n(i),{icon:n(q),onClick:e[2]||(e[2]=o=>r("left"))},null,8,["icon"]),v(n(i),{icon:n(G),onClick:e[3]||(e[3]=o=>r("right"))},null,8,["icon"])])],64)}}});export{O as default};
